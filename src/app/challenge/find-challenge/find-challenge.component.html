<div class="relative sm:h-full">
  <div class="relative p-10 pb-12 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
    <span *ngIf="isLoading" class="loading loading-spinner loading-lg text-dark-lavender col-span-full ml-auto mr-auto"></span>
    <div  *ngFor="let challenge of challenges; let index = index;" class="relative">
      <app-challenge (click)="getModal(index).showModal()" [challenge]="challenge" class="relative hover:cursor-pointer"></app-challenge>
      <div *ngIf="userIsSubscribe(challenge)" class="absolute -top-2 -right-2 fill-light-green text-dark-lavender">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g stroke="currentColor" stroke-linecap="round" stroke-width="1.5"><path d="M7 3.338A9.954 9.954 0 0 1 12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12c0-1.821.487-3.53 1.338-5"/><path stroke-linejoin="round" d="m8.5 12.5l2 2l5-5"/></g></svg>
      </div>

      <dialog id="subscribe_{{index}}" class="modal modal-bottom sm:modal-middle">
        <div class="modal-box bg-light-lavender">
          <h3 class="font-bold text-lg">
            @if(userIsSubscribe(challenge)){
            Vous relevez déjà le défi "{{challenge.name}}".
            } @else {
            Relever le défi "{{challenge.name}}" ?
            }
          </h3>
          <p  *ngIf="!userIsSubscribe(challenge)" class="py-4">Vous devrez ajouter une entrée au fur et à mesure que les jours passent afin de progresser.</p>
          <div class="modal-action">
            <form method="dialog">
              <button class="w-10 h-10 rounded-full text-dark-lavender fill-none hover:fill-lavender absolute right-2 top-2">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="m14.5 9.5l-5 5m0-5l5 5M7 3.338A9.954 9.954 0 0 1 12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12c0-1.821.487-3.53 1.338-5"/></svg>
              </button>
              <button class="button-dc bg-light-lavender hover:bg-lavender hover:text-dark-lavender mr-3">Annuler</button>
              @if(userIsSubscribe(challenge)){
              <button (click)="unsubscribe(challenge)" class="button-dc">J'arrête ce challenge</button>
              } @else {
              <button (click)="subscribe(challenge)" class="button-dc">C'est parti !</button>
              }
            </form>
          </div>
        </div>
      </dialog>
    </div>
  </div>
  <div class="fixed bottom-32 sm:bottom-0 right-0 w-2/5 text-amber-400 text-opacity-10 -z-10">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M22 8.162v.073c0 .86 0 1.291-.207 1.643c-.207.352-.584.561-1.336.98l-.793.44c.546-1.848.729-3.834.796-5.532l.01-.221l.002-.052c.651.226 1.017.395 1.245.711c.283.393.283.915.283 1.958m-20 0v.073c0 .86 0 1.291.207 1.643c.207.352.584.561 1.336.98l.794.44c-.547-1.848-.73-3.834-.797-5.532l-.01-.221l-.001-.052c-.652.226-1.018.395-1.246.711C2 6.597 2 7.12 2 8.162"/><path fill="currentColor" fill-rule="evenodd" d="M16.377 2.347A26.373 26.373 0 0 0 12 2c-1.783 0-3.253.157-4.377.347c-1.139.192-1.708.288-2.184.874c-.475.586-.45 1.219-.4 2.485c.173 4.348 1.111 9.78 6.211 10.26V19.5H9.82a1 1 0 0 0-.98.804l-.19.946H6a.75.75 0 0 0 0 1.5h12a.75.75 0 0 0 0-1.5h-2.65l-.19-.946a1 1 0 0 0-.98-.804h-1.43v-3.534c5.1-.48 6.039-5.911 6.211-10.26c.05-1.266.076-1.9-.4-2.485c-.476-.586-1.045-.682-2.184-.874" clip-rule="evenodd"/></svg>
  </div>
</div>
